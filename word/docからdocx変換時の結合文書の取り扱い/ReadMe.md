## 動機

doc 形式の文書を docx 形式に変換してサイズを小さくしたい
しかし、結合文書は doc ファイルを参照しているため、doc ファイルを docx 形式に変換するとリンクが切れてしまう。  
参照ファイルが数個なら一から作り直せば良いが、100 個以上もあると
中々骨が折れる作業だ。  
そこで効率的な方法を見つけたので備忘録としてメモしておく。

---

[フォルダ構成]  
フォルダ  
　 ├ 結合文書.doc  
　 ├ 参照文書.doc  
　 ├ 参照文書.doc  
　・  
　・  
　・  
　 └ 参照文書.doc

---

[元の文書イメージ]

![doc](https://github.com/pea-sys/office-experiments/assets/49807271/bc729723-2c2c-4974-a819-468381908729)

- 1.まずは doc 形式を docx 形式に一括置換する  
  スクリプトは以下のものを使用  
  https://github.com/pea-sys/shell-experiments/tree/main/powershell/doc2docx  
  ※変換しただけだと doc ファイルを参照している結合文書のリンクが切れてしまう

* 2.結合文書の拡張子を zip にする(docx と zip の圧縮形式は同じ)
* 3.上記ファイルを解凍する
* 4.word/\_rels_document.xml.rels をテキストエディタで開く
* 5.「.doc"」を「.docx"」に全置換
* 6.解凍ファイルを全て選択して、右クリックしてコンテキストメニューを開く
* 7.送るボタンから zip フォルダを選択する
* 8.生成された zip フォルダを元の結合文書にリネームする
* 9.リネームしたファイルを開いて動作確認する
